<button type="@(EditContext == null ? "button" : "submit")" class="btn btn@(IsOutLine ? "-outline" : String.Empty)-@(Color.ToString().ToLower()) @(String.IsNullOrEmpty(CssClass) ? String.Empty : CssClass)" @onclick="ButtonClickedEvent">
    @if (IsBussy)
    {
        <span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
        <text>@IsBussyCaption...</text>
    }
    else
    {
        <text>@Caption</text>
        @if (Icon != null)
        {
            <text>@(" ")</text>
            <span class="oi oi-@(Icon.ToString()!.ToLower().Replace("_","-")) align-middle"></span>
        }
    }
</button>

@code {
    [Parameter] public string CssClass{ get; set; }
    [Parameter] public ColorEnum Color { get; set; }
    [Parameter] public IconEnum? Icon { get; set; }
    [Parameter] public string Caption { get; set; }
    [Parameter] public bool IsOutLine { get; set; }
    [Parameter] public bool IsBussy { get; set; }
    [Parameter] public string IsBussyCaption { get; set; }
    [Parameter] public EventCallback OnClick { get; set; }
    [Parameter] public EditContext EditContext { get; set; }

    private async Task ButtonClickedEvent()
    {
        IsBussy = true;

        if (EditContext == null)
            await OnClick.InvokeAsync();
        else
            if (EditContext.Validate())
            await OnClick.InvokeAsync();

        IsBussy = false;
    }
}
