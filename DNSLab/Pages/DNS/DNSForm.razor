@inject IStringLocalizer<Resource> localizer

<EditForm Model="HostName" Context=DNSContext>
    <DataAnnotationsValidator />
    <div class="card mb-4">
        <div class="card-header"><BitLabel>@Title</BitLabel></div>
        <div class="card-body">
            <div class="row gx-3 mb-3">
                <div class="col-md-6">
                    <BitTextField Label="@localizer["HostName"]" Class="dir-ltr" Placeholder="@localizer["EnterYourHostName"]" @bind-Value="@HostName.Name" IsRequired IsEnabled="@IsNewRecord" />
                </div>
                <div class="col-md-6">
                    @switch (HostName.RecordType)
                    {
                        case 1:
                            <BitTextField Label="@localizer["IPv4Address"]" Class="dir-ltr" Placeholder="@IPDTO.IPv4" @bind-Value="@HostName.IPv4Address" IsRequired />
                            break;
                        case 2:
                            <BitTextField Label="@localizer["IPv6Address"]" Class="dir-ltr" Placeholder=@(localizer["ex"] + ":2001:0db8:85a3:0000:0000:8a2e:0370:7334") @bind-Value="@HostName.IPv6Address" IsRequired />
                            break;
                        case 3:
                            <BitTextField Label="@localizer["Target"]" Class="dir-ltr" Placeholder=@(localizer["ex"] + ":MyHost.dnslab.ir") @bind-Value="@HostName.HostNameAlias" IsRequired />
                            break;
                        case 4:
                            <BitTextField Label="@localizer["Target"]" Class="dir-ltr" Placeholder=@(localizer["ex"] + ":https://google.com یا "+ "http://" + @IPDTO.IPv4) @bind-Value="@HostName.URLOrIp" IsRequired />
                            break;
                    }
                </div>
            </div>
            <div class="row">
                @if (IsNewRecord)
                {
                    <div class="col-md-4 col-xl-3">
                        <BitRadioButtonList IsRtl=true
                                        Label="نوع رکورد"
                                        @bind-Value="@HostName.RecordType"
                                        Items="RecordTypes"
                                        TextField="@nameof(RecordType.Text)"
                                        ValueField="@nameof(RecordType.Value)">

                        </BitRadioButtonList>
                    </div>
                }
                <div class="@(IsNewRecord == true ? "col-md-8 col-xl-9" : String.Empty)">
                    <BitMessageBar MessageBarType="BitMessageBarType.Info">
                        @switch (HostName.RecordType)
                        {
                            case 1:
                                <BitLabel class="card-text">@localizer["DNSHostDescription"]</BitLabel>
                                break;
                            case 2:
                                <BitLabel class="card-text">@localizer["AAAADescription"]</BitLabel>
                                <BitLabel>* توجه فرمایید در حال حاضر رکورد های IPv6 در ایران پشتیبانی نمیشوند.</BitLabel>
                                break;
                            case 3:
                                <BitLabel class="card-text">@localizer["DNSAliasDescription"]</BitLabel>
                                break;
                            case 4:
                                <BitLabel class="card-text">@localizer["WebRedirectDescription"]</BitLabel>
                                break;
                        }
                    </BitMessageBar>
                </div>
            </div>
            <hr />
            <BaseButtonComponent Caption=@localizer["SaveChanges"]
                                 IsBussyCaption=@localizer["Progressing"]
                                 Color=ColorEnum.Primary
                                 Icon=BitIconName.Save
                                 EditContext=DNSContext
                                 OnClick=OnValidSubmit></BaseButtonComponent>
            <BaseNavigateButtonComponent Text=@localizer["Cancel"]
                                         Icon=BitIconName.Cancel
                                         Href="DNS/MyDNS"></BaseNavigateButtonComponent>
        </div>
    </div>

</EditForm>

@code {
    [Parameter] public HostNameDTO HostName { get; set; }
    [Parameter] public string Title { get; set; }
    [Parameter] public EventCallback OnValidSubmit { get; set; }
    [Parameter] public bool IsNewRecord { get; set; } = false;
    [CascadingParameter] public IPDTO IPDTO { get; set; }

    public class RecordType
    {
        public string Text { get; set; }
        public string Value { get; set; }
    }

    public List<RecordType> RecordTypes = new List<RecordType>
    {
        new RecordType {Text= "DNS Host (A)" ,Value = "1"},
        new RecordType {Text= "AAAA (IPv6)" ,Value = "2"},
        new RecordType {Text= "DNS Alias (CNAME)" ,Value = "3"},
        new RecordType {Text= "Web Redirect" ,Value = "4"},
    };

    protected override void OnAfterRender(bool firstRender)
    {
        if (String.IsNullOrEmpty(HostName.IPv4Address))
            HostName.IPv4Address = IPDTO.IPv4;
    }
}